# 資料清理過程記錄

**原始檔案**: `cofacts_integrated_20251103_22_cleaned_20251110_222837_text_length_filter.xlsx`
**檔案位置**: `C:\Users\USER\Desktop\資料集清洗\cofacts\5_清洗(...)`
**開始時間**: 2025-11-16 14:45:26
**原始資料筆數**: 43,067
**原始特徵數量**: 21

---

## 📄 論文用說明（可直接複製）

### 資料預處理方法

本研究採用系統化的資料清理流程，以確保資料品質並提升模型效能。資料清理過程包含三個主要階段：缺失值處理、重複值移除與異常值偵測。所有清理步驟均記錄於日誌檔案中，以確保研究的可重現性 (reproducibility)。

#### 3.1 缺失值處理

缺失值處理採用分層策略 (hierarchical strategy)：

1. **特徵層級處理**：當特徵的缺失率超過預設閾值時，該特徵將被移除。此策略基於資訊理論，認為缺失率過高的特徵對模型貢獻有限 (Little & Rubin, 2019)。

2. **資料列層級處理**：當資料列的缺失率超過預設閾值時，該筆資料將被移除。此做法可避免保留品質不佳的樣本，影響模型訓練效果。

3. **數值型特徵處理**：對於選定的數值型特徵，若存在缺失值則刪除該筆資料。此方法可保持數值資料的完整性與準確性，避免填補方法引入的偏差 (bias)。

4. **類別型特徵處理**：對於類別型特徵，缺失值以 'UNKNOWN' 標記。此方法可保留資料筆數，同時明確標示缺失狀態。

#### 3.2 重複值處理

重複值處理採用完全比對法 (exact matching)，當資料列的所有特徵值完全相同時，保留第一筆資料，刪除後續重複項。此方法可避免資料重複導致的模型過擬合問題。

#### 3.3 異常值偵測與處理

異常值偵測採用四分位距法 (Interquartile Range, IQR)，此方法對資料分布的假設較少，適用於各種類型的數值資料 (Tukey, 1977)。異常值定義如下：

```
Q1 = 第一四分位數 (25th percentile)
Q3 = 第三四分位數 (75th percentile)
IQR = Q3 - Q1
下界 = Q1 - 1.5 × IQR
上界 = Q3 + 1.5 × IQR
```

超出上下界範圍的數值即被視為異常值。異常值處理方式可選擇：
(1) 邊界值替換法：將異常值替換為對應的邊界值，保留資料筆數；
(2) 直接刪除法：刪除包含異常值的資料列，確保資料品質；
(3) 保留原值：用於探索性分析階段。

#### 參考文獻

- Little, R. J., & Rubin, D. B. (2019). *Statistical analysis with missing data* (Vol. 793). John Wiley & Sons.
- Tukey, J. W. (1977). *Exploratory data analysis* (Vol. 2). Reading, MA: Addison-Wesley.

---

## 🔧 詳細執行記錄

## 操作 1：處理缺失值

**執行時間**: 2025-11-16 14:45:53

**結果**: 用戶跳過缺失值處理

---

## 操作 1：處理缺失值

**執行時間**: 2025-11-16 14:46:17

### 缺失值分析

**參數設定**:
- 特徵缺失閾值: 100.0%
- 資料列缺失閾值: 100.0%
- 選中的數值型特徵: 2 個

**將處理的數值型特徵** (2 個):

- `articles_text`: 433 筆 (1.01%) → **將刪除這些資料列**
- `replies_text`: 2 筆 (0.00%) → **將刪除這些資料列**

### 執行過程

**步驟 3**: 刪除 articles_text [文字型] 有缺失值的 433 筆資料
- 刪除索引範圍: [144, 288, 316, 317, 341, 375, 420, 458, 592, 682]...

**步驟 4**: 刪除 replies_text [文字型] 有缺失值的 2 筆資料
- 刪除索引範圍: [28169, 33975]

**步驟 5**: 填補 articles_updatedAt 的 742 個缺失值為 UNKNOWN
- 填補索引範圍: [20290, 20294, 20302, 20348, 20406, 20464, 20469, 20486, 20571, 20584]...

**步驟 6**: 填補 replies_reference 的 7 個缺失值為 UNKNOWN
- 填補索引範圍: [2472, 11210, 13337, 25838, 26136, 27239, 38134]

**步驟 7**: 填補 replies_createdAt 的 1 個缺失值為 UNKNOWN
- 填補索引範圍: [25245]

**步驟 8**: 填補 replies_userIdsha256 的 2 個缺失值為 UNKNOWN
- 填補索引範圍: [25245, 26094]

**步驟 9**: 填補 categories_title 的 11,628 個缺失值為 UNKNOWN
- 填補索引範圍: [0, 1, 2, 3, 4, 5, 7, 8, 9, 10]...

**步驟 10**: 填補 categories_id 的 11,628 個缺失值為 UNKNOWN
- 填補索引範圍: [0, 1, 2, 3, 4, 5, 7, 8, 9, 10]...

**步驟 11**: 填補 article_hyperlinks_url 的 33,266 個缺失值為 UNKNOWN
- 填補索引範圍: [0, 1, 2, 3, 4, 5, 6, 9, 10, 11]...

**步驟 12**: 填補 reply_hyperlinks_url 的 1,050 個缺失值為 UNKNOWN
- 填補索引範圍: [131, 153, 239, 314, 315, 371, 372, 391, 423, 476]...

### 結果統計

- 刪除特徵數: 0
- 刪除資料列數: 435
- 剩餘資料: 42,632 筆, 21 個特徵

---

## 儲存結果

**儲存時間**: 2025-11-16 15:16:30

**輸出檔案**: `cofacts_integrated_20251103_22_cleaned_20251116_151618_缺失值.xlsx`
**檔案位置**: `C:\Users\USER\Desktop\資料集清洗\cofacts\5_清洗(...)`
**清理步驟**: missing

### 最終統計

| 項目 | 清理前 | 清理後 | 變化 |
|------|--------|--------|------|
| 資料筆數 | 43,067 | 42,632 | +435 (+1.01%) |
| 特徵數量 | 21 | 21 | +0 (+0.00%) |
| 缺失值 | 59,736 | 0 | +59,736 |
| 重複值 | 0 | 0 | +0 |

### 清理參數設定

- 特徵缺失閾值: 100.0%
- 資料列缺失閾值: 100.0%
- 異常值處理方式: replace

### 執行的清理步驟

1. 刪除 articles_text [文字型] 有缺失值的 433 筆資料
2. 刪除 replies_text [文字型] 有缺失值的 2 筆資料
3. 填補 articles_updatedAt 的 742 個缺失值為 UNKNOWN
4. 填補 replies_reference 的 7 個缺失值為 UNKNOWN
5. 填補 replies_createdAt 的 1 個缺失值為 UNKNOWN
6. 填補 replies_userIdsha256 的 2 個缺失值為 UNKNOWN
7. 填補 categories_title 的 11,628 個缺失值為 UNKNOWN
8. 填補 categories_id 的 11,628 個缺失值為 UNKNOWN
9. 填補 article_hyperlinks_url 的 33,266 個缺失值為 UNKNOWN
10. 填補 reply_hyperlinks_url 的 1,050 個缺失值為 UNKNOWN

---

## 📊 論文用結果說明（可直接複製）

### 資料清理結果

經過系統化的資料清理流程後，原始資料集從 43,067 筆資料減少至 42,632 筆（移除 435 筆，約 1.01%），保留所有 21 個特徵。清理後的資料集缺失值從 59,736 個減少至 0 個，重複值從 0 筆減少至 0 筆，顯著提升了資料品質。

### 清理參數設定

本研究採用以下參數進行資料清理：

- **特徵缺失閾值**：100.0%
- **資料列缺失閾值**：100.0%
- **異常值處理方式**：邊界值替換法 (Boundary Value Replacement)

### 清理前後對比

| 項目 | 清理前 | 清理後 | 變化量 | 變化率 |
|------|--------|--------|--------|--------|
| 資料筆數 | 43,067 | 42,632 | +435 | +1.01% |
| 特徵數量 | 21 | 21 | +0 | +0.00% |
| 缺失值總數 | 59,736 | 0 | +59,736 | +100.00% |
| 重複值數量 | 0 | 0 | +0 | +0.00% |

### 資料品質評估

清理後資料集的整體缺失率為 0.00%，資料完整性極佳，適合進行後續的機器學習模型訓練。

---

**清理完成時間**: 2025-11-16 15:16:31
**總操作數**: 1
**處理時長**: 1865.98 秒
